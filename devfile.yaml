apiVersion: 2.2.0
metadata:
  name: java-companion-project
projects:
  - name: java-companion-project
    git:
      remotes:
        origin: "https://github.com/Mbd06b/bootcamper-project.git"
        
attributes:
  controller.devfile.io/devworkspace-config:
    name: devworkspace-config
    namespace: eclipse-che
  controller.devfile.io/storage-type: per-user
  
components:
  - name: maven
    container:
      image: "maven:3.8.1-jdk-11"
      memoryLimit: 512Mi
      mountSources: true
      volumes:
        - name: maven-repo
          containerPath: /root/.m2
      endpoints:
        - name: 'http-8080'
          targetPort: 8080
      env:
        - name: MAVEN_OPTS
          value: "-Xmx200m -XX:MaxPermSize=128m"

  - name: ide
    plugin:
      id: che-incubator/che-idea/next

commands:
  - id: mvn-compile
    label: Compile
    exec:
      component: maven
      commandLine: "mvn clean install -f ${CHE_PROJECTS_ROOT}/bootcamper-project/pom.xml"
      group:
        kind: build
        isDefault: true

  - id: mvn-spring-boot-run
    label: Run Spring Boot Provider
    exec:
      component: maven
      commandLine: "mvn spring-boot:run -f ${CHE_PROJECTS_ROOT}/bootcamper-project/mgl-provider"
      group:
        kind: run

  - id: mvn-jetty-run
    label: Run Jetty Server
    exec:
      component: maven
      commandLine: "mvn jetty:run -f ${CHE_PROJECTS_ROOT}/bootcamper-project/mgl-webapp_review"
      group:
        kind: run
